/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

'use strict';var g=require("lexical"),x=require("@lexical/selection"),C;function D(a){let b=new URLSearchParams;b.append("code",a);for(let c=1;c<arguments.length;c++)b.append("v",arguments[c]);throw Error(`Minified Lexical error #${a}; visit https://lexical.dev/docs/error?${b} for the full message or `+"use the non-minified dev environment for full errors and additional helpful warnings.");}C=D&&D.__esModule&&Object.prototype.hasOwnProperty.call(D,"default")?D["default"]:D;
let E="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,F=E&&"documentMode"in document?document.documentMode:null,G=E&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),H=E&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),I=E&&"InputEvent"in window&&!F?"getTargetRanges"in new window.InputEvent("input"):!1,J=E&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),K=E&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,
L=E&&/Android/.test(navigator.userAgent),M=E&&/^(?=.*Chrome).*/i.test(navigator.userAgent),N=E&&L&&M;function O(...a){let b=[];for(let c of a)if(c&&"string"===typeof c)for(let [d]of c.matchAll(/\S+/g))b.push(d);return b}function P(...a){return()=>{for(let b=a.length-1;0<=b;b--)a[b]();a.length=0}}let Q={attributes:!0,characterData:!0,childList:!0,subtree:!0};
function R(a,b,c){function d(){null===h&&C(182);null===l&&C(183);let {left:p,top:A}=h.getBoundingClientRect();var q=l;let r=x.createRectsFromDOMRange(a,b);t.isConnected||q.append(t);q=!1;for(let y=0;y<r.length;y++){var w=r[y];let u=k[y]||document.createElement("div"),z=u.style;"absolute"!==z.position&&(z.position="absolute",q=!0);var m=`${w.left-p}px`;z.left!==m&&(z.left=m,q=!0);m=`${w.top-A}px`;z.top!==m&&(u.style.top=m,q=!0);m=`${w.width}px`;z.width!==m&&(u.style.width=m,q=!0);w=`${w.height}px`;
z.height!==w&&(u.style.height=w,q=!0);u.parentNode!==t&&(t.append(u),q=!0);k[y]=u}for(;k.length>r.length;)k.pop();q&&c(k)}function f(){h=l=null;null!==n&&n.disconnect();n=null;t.remove();for(let p of k)p.remove();k=[]}function e(){let p=a.getRootElement();if(null===p)return f();let A=p.parentElement;if(!(A instanceof HTMLElement))return f();f();h=p;l=A;n=new MutationObserver(q=>{let r=a.getRootElement(),w=r&&r.parentElement;if(r!==h||w!==l)return e();for(let m of q)if(!t.contains(m.target))return d()});
n.observe(A,Q);d()}let h=null,l=null,n=null,k=[],t=document.createElement("div"),B=a.registerRootListener(e);return()=>{B();f()}}let S=E&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!M;function T(a,b){for(let c of b)if(a.type.startsWith(c))return!0;return!1}let U={done:!0,value:void 0};
function V(a,b){a=(a||g.$getRoot()).getLatest();let c=W(a),d=a,f=c,e=!0,h={next(){if(null===d)return U;if(e)return e=!1,{done:!1,value:{depth:f,node:d}};if(d===b)return U;if(g.$isElementNode(d)&&0<d.getChildrenSize())d=d.getFirstChild(),f++;else{let l;[d,l]=X(d)||[null,0];f+=l;null==b&&f<=c&&(d=null)}return null===d?U:{done:!1,value:{depth:f,node:d}}},[Symbol.iterator](){return h}};return h}
function X(a){let b=null,c=0;for(;null===b&&null!==a;)b=a.getNextSibling(),null===b?(a=a.getParent(),c--):a=b;return null===a?null:[a,c]}function W(a){let b=0;for(;null!==(a=a.getParent());)b++;return b}let Y=(a,b)=>{for(;a!==g.$getRoot()&&null!=a;){if(b(a))return a;a=a.getParent()}return null};exports.$splitNode=g.$splitNode;exports.isBlockDomNode=g.isBlockDomNode;exports.isHTMLAnchorElement=g.isHTMLAnchorElement;exports.isHTMLElement=g.isHTMLElement;exports.isInlineDomNode=g.isInlineDomNode;
exports.$dfs=function(a,b){return Array.from(V(a,b))};exports.$dfsIterator=V;exports.$filter=function(a,b){let c=[];for(let d=0;d<a.length;d++){let f=b(a[d]);null!==f&&c.push(f)}return c};exports.$findMatchingParent=Y;exports.$getDepth=W;exports.$getNearestBlockElementAncestorOrThrow=function(a){let b=Y(a,c=>g.$isElementNode(c)&&!c.isInline());g.$isElementNode(b)||C(4,a.__key);return b};exports.$getNearestNodeOfType=function(a,b){for(;null!=a;){if(a instanceof b)return a;a=a.getParent()}return null};
exports.$getNextRightPreorderNode=function(a){if(g.$isElementNode(a)&&0<a.getChildrenSize())a=a.getLastChild();else{let b=null;for(;null===b&&null!==a;)b=a.getPreviousSibling(),a=null===b?a.getParent():b}return a};exports.$getNextSiblingOrParentSibling=X;exports.$insertFirst=function(a,b){let c=a.getFirstChild();null!==c?c.insertBefore(b):a.append(b)};
exports.$insertNodeToNearestRoot=function(a){var b=g.$getSelection()||g.$getPreviousSelection();if(g.$isRangeSelection(b)){var {focus:c}=b;b=c.getNode();c=c.offset;if(g.$isRootOrShadowRoot(b))c=b.getChildAtIndex(c),null==c?b.append(a):c.insertBefore(a),a.selectNext();else{let d,f;g.$isTextNode(b)?(d=b.getParentOrThrow(),f=b.getIndexWithinParent(),0<c&&(f+=1,b.splitText(c))):(d=b,f=c);[,b]=g.$splitNode(d,f);b.insertBefore(a);b.selectStart()}}else null!=b?(b=b.getNodes(),b[b.length-1].getTopLevelElementOrThrow().insertAfter(a)):
g.$getRoot().append(a),b=g.$createParagraphNode(),a.insertAfter(b),b.select();return a.getLatest()};exports.$isEditorIsNestedEditor=function(a){return null!==a._parentEditor};exports.$restoreEditorState=function(a,b){let c=new Map,d=a._pendingEditorState;for(let [f,e]of b._nodeMap)c.set(f,g.$cloneWithProperties(e));d&&(d._nodeMap=c);a._dirtyType=2;a=b._selection;g.$setSelection(null===a?null:a.clone())};exports.$wrapNodeInElement=function(a,b){b=b();a.replace(b);b.append(a);return b};
exports.CAN_USE_BEFORE_INPUT=I;exports.CAN_USE_DOM=E;exports.IS_ANDROID=L;exports.IS_ANDROID_CHROME=N;exports.IS_APPLE=G;exports.IS_APPLE_WEBKIT=S;exports.IS_CHROME=M;exports.IS_FIREFOX=H;exports.IS_IOS=K;exports.IS_SAFARI=J;exports.addClassNamesToElement=function(a,...b){b=O(...b);0<b.length&&a.classList.add(...b)};exports.calculateZoomLevel=function(a){if(H)return 1;let b=1;for(;a;)b*=Number(window.getComputedStyle(a).getPropertyValue("zoom")),a=a.parentElement;return b};exports.isMimeType=T;
exports.markSelection=function(a,b){function c(n){n.read(()=>{var k=g.$getSelection();if(g.$isRangeSelection(k)){var {anchor:t,focus:B}=k;k=t.getNode();var p=k.getKey(),A=t.offset,q=B.getNode(),r=q.getKey(),w=B.offset,m=a.getElementByKey(p),y=a.getElementByKey(r);p=null===d||null===m||A!==f||p!==d.getKey()||k!==d&&(!(d instanceof g.TextNode)||k.updateDOM(d,m,a._config));r=null===e||null===y||w!==h||r!==e.getKey()||q!==e&&(!(e instanceof g.TextNode)||q.updateDOM(e,y,a._config));if(p||r){m=a.getElementByKey(t.getNode().getKey());
var u=a.getElementByKey(B.getNode().getKey());null!==m&&null!==u&&"SPAN"===m.tagName&&"SPAN"===u.tagName&&(r=document.createRange(),B.isBefore(t)?(p=u,y=B.offset,u=m,m=t.offset):(p=m,y=t.offset,m=B.offset),p=p.firstChild,null===p&&C(181),u=u.firstChild,null===u&&C(181),r.setStart(p,y),r.setEnd(u,m),l(),l=R(a,r,z=>{for(let Z of z){let v=Z.style;"Highlight"!==v.background&&(v.background="Highlight");"HighlightText"!==v.color&&(v.color="HighlightText");"-1"!==v.zIndex&&(v.zIndex="-1");"none"!==v.pointerEvents&&
(v.pointerEvents="none");"-1.5px"!==v.marginTop&&(v.marginTop="-1.5px");"4px"!==v.paddingTop&&(v.paddingTop="4px");"0px"!==v.paddingBottom&&(v.paddingBottom="0px")}void 0!==b&&b(z)}))}d=k;f=A;e=q;h=w}else h=e=f=d=null,l(),l=()=>{}})}let d=null,f=null,e=null,h=null,l=()=>{};c(a.getEditorState());return P(a.registerUpdateListener(({editorState:n})=>c(n)),l,()=>{l()})};
exports.mediaFileReader=function(a,b){let c=a[Symbol.iterator]();return new Promise((d,f)=>{let e=[],h=()=>{const {done:l,value:n}=c.next();if(l)return d(e);const k=new FileReader;k.addEventListener("error",f);k.addEventListener("load",()=>{const t=k.result;"string"===typeof t&&e.push({file:n,result:t});h()});T(n,b)?k.readAsDataURL(n):h()};h()})};exports.mergeRegister=P;exports.objectKlassEquals=function(a,b){return null!==a?Object.getPrototypeOf(a).constructor.name===b.name:!1};
exports.positionNodeOnRange=R;
exports.registerNestedElementResolver=function(a,b,c,d){return a.registerNodeTransform(b,f=>{a:{var e=f.getChildren();for(var h=0;h<e.length;h++)if(e[h]instanceof b){e=null;break a}for(e=f;null!==e;)if(h=e,e=e.getParent(),e instanceof b){e={child:h,parent:e};break a}e=null}if(null!==e){const {child:l,parent:n}=e;if(l.is(f)){d(n,f);f=l.getNextSiblings();e=f.length;n.insertAfter(l);if(0!==e){h=c(n);l.insertAfter(h);for(let k=0;k<e;k++)h.append(f[k])}n.canBeEmpty()||0!==n.getChildrenSize()||n.remove()}}})};
exports.removeClassNamesFromElement=function(a,...b){b=O(...b);0<b.length&&a.classList.remove(...b)}

# 建築業向け統合管理システム 仕様書

本書は、日本ロジックスの運送業向け注文管理システムをベースに、建築業の業務に適合させたオリジナルシステムの仕様を示す。

## 1. システム概要
- 建築プロジェクトごとの資材・人員・工事進捗を一元管理する。
- 発注から現場搬入、施工、検収までの情報を可視化し、関係者間の連携を強化する。
- Web ブラウザから利用し、モバイル端末でも操作可能なレスポンシブ UI を採用する。

## 2. 利用者と権限
| 役割 | 主な権限 |
|------|----------|
| 管理者 | システム全体設定、ユーザ管理、プロジェクト作成 |
| 施工管理者 | プロジェクト編集、資材発注、進捗登録、図面・資料管理 |
| 現場監督 | 日報登録、資材受入検収、作業指示確認 |
| 購買担当 | 資材・外注先の登録、発注書作成、納期管理 |
| 経理担当 | 請求書確認、支払処理、原価集計 |

権限はロールベースで実装し、API・UI の双方でアクセス制御を行う。

## 3. 機能要件
### 3.1 プロジェクト管理
- プロジェクト単位で工期、現場住所、責任者、ステータスを登録。
- 図面、契約書、写真などのファイルを関連付けて保管。

### 3.2 資材発注・在庫管理
- 資材カタログを作成し、単価・仕様・仕入先を管理。
- プロジェクトごとに必要数量を計算し、発注書を自動生成。
- 入荷時には検収記録を残し、現場在庫をリアルタイムで把握。

### 3.3 外注・職人管理
- 外注業者、職人の技能・単価・契約情報を登録。
- 作業指示書の発行、作業実績の記録、支払予定の算出を支援。

### 3.4 進捗・品質・安全管理
- 各工程の進捗率と予定日を記録し、遅延アラートを通知。
- 品質検査結果、是正記録、安全パトロール報告を保存。

### 3.5 コスト・請求管理
- 資材費・外注費・労務費を集計し、予算との差異を可視化。
- 請求書・支払情報を連携し、原価管理帳票を出力。

### 3.6 通知・レポート
- 納期遅延、予算超過、品質問題をメールやチャットに通知。
- プロジェクト別のダッシュボードや週次レポートを生成。

## 4. 非機能要件
- **可用性**: 99.5% 以上の稼働率を目標とし、主要コンポーネントは冗長化する。
- **セキュリティ**: OAuth2 による認証、ロールベースアクセス制御、監査ログを実装。
- **性能**: 通常利用で 1 秒以内の応答、100 同時ユーザを想定。
- **拡張性**: プロジェクト・資材数が増加してもスケール可能なクラウドアーキテクチャ。

## 5. システム構成
本システムはモノリポ構成で、次のディレクトリを持つ。
```
.
├── app            # フロントエンド (React)
├── api            # バックエンド (Go)
├── portal         # Docusaurus ベースのドキュメント
├── cdk            # AWS CDK によるインフラ構築コード
└── e2e            # Playwright による E2E テスト
```
- 既存の Node.js / Go / MySQL / MinIO 構成をそのまま利用する。
- Swagger により API 仕様を公開し、orval でフロントのクライアントを生成する。

## 6. 主なエンティティ
| エンティティ | 概要 |
|---------------|------|
| Project | 建築プロジェクト。工期、所在地、顧客情報を保持 |
| SiteMaterial | 現場資材。在庫量、保管場所、使用予定日を管理 |
| PurchaseOrder | 資材・外注の発注情報。納期、仕入先、金額を保持 |
| Supplier | 資材仕入先や外注業者。連絡先、契約条件を管理 |
| Task | 工程。担当者、開始・完了予定日、進捗率を保持 |
| Report | 日報・検査報告・安全報告などの文書 |

## 7. 典型的な業務フロー
1. 管理者が新規プロジェクトを作成し、施工管理者・現場監督を割り当てる。
2. 施工管理者が資材カタログを基に必要数量を算出し、購買担当へ発注依頼。
3. 購買担当が仕入先へ発注、納期を登録。
4. 資材到着後、現場監督が検収を行い在庫を更新。
5. 現場監督が日報で進捗・安全状況を記録。
6. 経理担当が請求書を確認し、支払処理と原価集計を実施。

## 8. 将来的な拡張
- BIM との連携による図面・3D モデルとのデータ統合。
- IoT センサーを用いた現場の環境・稼働状況の自動取得。
- AI による工程遅延予測や原価予測。

---
本仕様書は初期リリースに向けた指針であり、実装の進行に合わせて随時更新する。
